# ADR-024: ログインボーナスおよび誕生日ボーナスシステムの導入

## ステータス
承認済み

## 背景
アプリのDAU（Daily Active Users）向上とリテンション強化のため、日常的な利用に対するインセンティブが必要とされている。

## 決定事項
「デイリーログインボーナス」と「誕生日ボーナス」を導入し、ユーザーの継続利用を促進する。

### 仕様詳細

#### 1. デイリーログインボーナス
- **付与額**: 10pt / 日
- **条件**: JST（日本標準時）の0:00切り替えで、その日最初のアプリ起動時に付与。
- **実装**: 
  - `BonusChecker` クライアントコンポーネントがアプリ起動時（Layoutマウント時）に Server Action を呼び出す。
  - `profiles` テーブルに `last_login_bonus_at` と `consecutive_login_days` カラムを追加して管理。
  - 連続ログイン日数は記録するが、現時点ではボーナス額の変動は行わない（将来拡張用）。

#### 2. 誕生日ボーナス
- **付与額**: 500pt / 年
- **条件**: プロフィールの生年月日（月日）と現在の日付（JST）が一致する日の初回ログイン時。
- **実装**:
  - `profiles` テーブルに `last_birthday_bonus_year` カラムを追加し、年1回の付与を保証する。
  - 獲得時に画面全体で祝賀エフェクト（Confetti）を表示する。

### 技術的選定
- **日付管理**: 全てサーバーサイド（Server Action内）で JST に変換して判定を行う。クライアント時刻には依存しない。
- **UIフィードバック**: `sonner` ライブラリを使用したトースト通知を採用。誕生日演出には `canvas-confetti` を使用。

## メリット
- ユーザーの毎日起動する動機付けになる。
- 誕生日の特別感によるエンゲージメント向上が期待できる。

## デメリット
- ポイント発行総量が増加するため、長期的にはポイント経済圏のバランス調整が必要になる可能性がある。

## 関連資料
- `docs/specs/point_system.md`
